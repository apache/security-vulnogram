extends ../../default/cve/edit

block append bannerItemsLeft
      a.icn.btn.Search.right(type="button",value="Google",href="https://google.com/search?q=\""+doc.body.CVE_data_meta.ID+"\"",target="_blank") Google
      a.icn.btn.Search.right(type="button",value="CVE",href="https://cve.mitre.org/cgi-bin/cvename.cgi?name="+doc.body.CVE_data_meta.ID,target="_blank") CVE

block loadEditor

    script 
        | var loadEditorWithProducts = async function() {
        |   docSchema.definitions.product.properties.product_name.examples = await 
        | loadProductNames();
        | loadJSON(initJSON)
        | };
        | loadEditorWithProducts();

    script
        | selected = "aboutTab";
        | document.getElementById(selected).checked = true;
        
    script
        | var tabs = document.getElementsByName("tabs");
        | for (var i = 0; i < tabs.length; i++) {
        |   var t = tabs[i];
        |   if (t.id == "emailTab") {
        |     t.addEventListener('change',function() {
        |         var j = docEditor.getValue();
        |         j.who = "oss";
        |         document.getElementById("outemail").innerHTML = pugRender({renderTemplate: 'email', doc: j });
        |     });
        |   }
        |   if (t.id == "ASFemailTab") {
        |     t.addEventListener('change',function() {
        |         var j = docEditor.getValue();
        |         j.who = "asf";        
        |         document.getElementById("asfemail").innerHTML = pugRender({renderTemplate: 'email', doc: j });
        |     });        
        |   }
        | }
        
block customtabs
        input.tab(name='tabs', type='radio', id='jsonTab', value="6")
        label.lbl(for='jsonTab') CVE-JSON            
        .wht.fil.bor.pad
            div(style='float:right')
                a.icn.right.copy.btn(onmouseover='this.textContent="Copy"',onclick='copyText(outjson);this.textContent="Copied"') Copy
                | 
                a.icn.right.download.btn(onclick='downloadText(outjson, this);') Download
            .pre#outjson
        input.tab(name='tabs', type='radio', id='advisoryTab', value="4")
        label.lbl(for='advisoryTab') Advisory
        .wht.fil.bor.pad
            div.render(id="render")
        input.tab(name='tabs', type='radio', id='emailTab', value="7")
        label.lbl(for='emailTab') OSS-Email
        .wht.fil.bor.pad
            div(style='float:right')
                a.icn.right.copy.btn(onmouseover='this.textContent="Copy"',onclick='copyText(outemail);this.textContent="Copied"')  Copy
            div#outemail
        input.tab(name='tabs', type='radio', id='ASFemailTab', value="8")
        label.lbl(for='ASFemailTab') ASF-Email
        .wht.fil.bor.pad
            div(style='float:right')
                a.icn.right.copy.btn(onmouseover='this.textContent="Copy"',onclick='copyText(asfemail);this.textContent="Copied"')  Copy
        
            div#asfemail

block append customtabs
        input.tab(name='tabs', type='radio', id='aboutTab', value="0")
        label.lbl(for='aboutTab') Instructions
        .wht.fil.bor.pad
         p!= "This site is designed to help you handle vulnerabilities according to the <a href='https://www.apache.org/security/committers.html' target='_blank'>ASF CVE process</a>, step 16.  A short <a href='https://s.apache.org/cveprocessvideo' target='_blank'>video overview</a> is also available."
         ul
             li!= "Fill in the details on <a href='#editor'>'Editor'</a> tab setting. Any field marked optional is not required and it is not given to the CVE project but is used for the emails. "
             p=""
             li!= "The information you enter is stored when you hit SAVE.  It is only visible to other members of your PMC and the ASF security team.  So you can prepare some of it in advance."
             p=""
             li!= "Once you go public.  Use the <a href='#email'>'OSS-Email'</a> tab for the email you should send to oss-security. Use the <a href='#ASFemail'>'ASF-Email'</a> tab for the email to Apache lists.  Also update your security page if you have one."
             p=""
             li!= "Fill in a 'reference' type 'CONFIRM' with the URL to your public post about this issue.  Then set the state to 'READY'.  This auto notifies ASF Security who will review and submit to Mitre and then set state to 'PUBLIC'."
             p=""
             li!= "'REVIEW' state is optional. Set this if you want ASF Security to be notified to help with this entry."
         p=""
         p!= "For further help contact <a href='mailto:security@apache.org' target='_blank'>security@apache.org</a>."

block logolink

